<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Meu Afilhado</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/4c3b22a05f.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/sidebar.css" />
    <link rel="stylesheet" href="../../css/notifications.css" />
    <link rel="stylesheet" href="../../css/afilhado_newuser.css" />
  </head>

  <body
    class="bg-gradient-to-br from-slate-900 via-purple-950 to-indigo-950 min-h-screen flex flex-col"
  >
    <div
      class="sidebar fixed top-0 left-0 h-full w-20 hover:w-56 bg-purple-200 overflow-hidden transition-all duration-300 z-50"
    >
      <ul class="flex flex-col">
        <li class="flex items-center p-4 hover:bg-purple-400 cursor-pointer">
          <img src="../../imagens/home.jpg" class="w-6 h-6" alt="Home" />
          <span class="ml-3 text-black hidden sidebar-text">Home</span>
        </li>
        <li class="flex items-center p-4 hover:bg-purple-400 cursor-pointer">
          <img src="../../imagens/cursos.jpg" class="w-6 h-6" alt="Meus Cursos" />
          <span class="ml-3 text-black hidden sidebar-text">Meus Cursos</span>
        </li>
        <li class="flex items-center p-4 hover:bg-purple-400 cursor-pointer">
          <img src="../../imagens/desenvolvimento.jpg" class="w-6 h-6" alt="Meu Desenvolvimento" />
          <span class="ml-3 text-black hidden sidebar-text">Meu Desenvolvimento</span>
        </li>
        <li class="flex items-center p-4 hover:bg-purple-400 cursor-pointer">
          <img src="../../imagens/perfil2.jpg" class="w-6 h-6" alt="Meu Perfil" />
          <span class="ml-3 text-black hidden sidebar-text">Meu Perfil</span>
        </li>
        <li class="flex items-center p-4 hover:bg-purple-400 cursor-pointer">
          <img src="../../imagens/configuracao.jpg" class="w-6 h-6" alt="Configurações" />
          <span class="ml-3 text-black hidden sidebar-text">Configurações</span>
        </li>
      </ul>
    </div>

    <main class="flex-1 p-4 md:ml-20 md:mt-0 mt-16">
      <header
        class="flex flex-col md:flex-row justify-between items-center mb-8 space-y-4 md:space-y-0"
      >
        <h1 class="text-2xl font-bold text-purple-200">Página Inicial</h1>
        <div class="flex items-center space-x-4 relative">
          <img
            id="notifIcon"
            src="../../imagens/notificacao.jpg"
            alt="Notificações"
            class="w-7 h-6 rounded-full cursor-pointer"
          />

          <span class="text-purple-200">Olá, Novo Usuário</span>
          <button
            class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition"
          >
            Desconectar
          </button>

          <div
            id="notifModal"
            class="hidden absolute top-10 right-0 w-96 bg-white text-black rounded-2xl shadow-lg p-3 z-50"
          >
            <div class="notif-item">
              <img src="../../imagens/avatar.png" alt="Avatar" />
              <p>
                <strong>Sistema:</strong> Parece que o usuário XXXXX está terminando o curso, agende
                seu 1:1 com ele =)
              </p>
            </div>
            <div class="notif-item">
              <img src="../../imagens/avatar.png" alt="Avatar" />
              <p>
                <strong>Buddy:</strong> Oie, estou preocupado com certo onboard aqui, podemos
                conversar?
              </p>
            </div>
            <div class="notif-item">
              <img src="../../imagens/avatar.png" alt="Avatar" />
              <p>
                <strong>Sistema:</strong> Parece que o usuário XXXXX está terminando o curso, agende
                seu 1:1 com ele =)
              </p>
            </div>
            <div class="notif-item">
              <img src="../../imagens/avatar.png" alt="Avatar" />
              <p>
                <strong>Buddy:</strong> Fala xxxx, bora trocar uma palavra? Vi que está um pouco
                atrasado... posso te ajudar? =)
              </p>
            </div>
          </div>
        </div>
      </header>

      <section class="afilhado-info">
        <h2>MEU AFILHADO</h2>
        <div class="perfil">
          <img src="../../imagens/perfil.png" alt="avatar" />
          <div class="info-text">
            <p><strong>Lorem ipsum dolor sit amet</strong></p>
            <p>
              In mauris neque, eleifend pretium risus nec, sollicitudin egestas orci. Class aptent
              taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Fusce
              congue ultricies dui sit amet maximus. Vestibulum
            </p>
          </div>
        </div>
      </section>

      <section class="progress-message">
        <div class="progress-chart">
          <canvas id="myPieChart"></canvas>
        </div>
        <div class="message-box">
          <textarea placeholder="Enviar mensagem:"></textarea>
          <button id="saveSchedule">Salvar Agendamento</button>
        </div>
      </section>
    </main>

    <button class="help-btn">?</button>

    <script>
      // Alternar modo escuro (caso exista o botão)
      const toggle = document.getElementById('darkModeToggle');
      if (toggle) {
        toggle.addEventListener('change', () => {
          if (toggle.checked) {
            document.body.style.background = '#222';
            document.body.style.color = 'white';
          } else {
            document.body.style.background = '';
            document.body.style.color = '';
          }
        });
      }

      // Evento para salvar agendamento (versão com notificações)
      const saveButton = document.getElementById('saveSchedule');
      if (saveButton) {
        saveButton.addEventListener('click', () => {
          const message = document.querySelector('textarea').value.trim();
          if (message.length > 0) {
            // Criar item de notificação
            const notifItem = document.createElement('div');
            notifItem.classList.add('notif-item');
            notifItem.innerHTML = `
            <img src="../../imagens/avatar.png" alt="Avatar">
            <p><strong>Você:</strong> ${message}</p>
          `;

            // Adiciona no topo da lista de notificações
            const notifModal = document.getElementById('notifModal');
            notifModal.prepend(notifItem);

            // Limpa a caixa de texto
            document.querySelector('textarea').value = '';

            // Feedback opcional
            alert('Mensagem enviada para notificações!');
          } else {
            alert('Digite uma mensagem antes de salvar.');
          }
        });
      }

      // Gráfico de pizza
      const data = {
        labels: [
          'Finalizações de Cursos',
          'Categoria 2',
          'Categoria 3',
          'Categoria 4',
          'Categoria 5',
        ],
        datasets: [
          {
            data: [30, 15, 25, 10, 20],
            backgroundColor: ['#8a52f1', '#ff6347', '#4caf50', '#ff9800', '#c0c0c0'],
            borderWidth: 0,
          },
        ],
      };

      const config = {
        type: 'pie',
        data: data,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: { enabled: true },
          },
        },
      };

      // Criar gráfico
      window.addEventListener('load', () => {
        const ctx = document.getElementById('myPieChart').getContext('2d');
        new Chart(ctx, config);
      });

      // Controle do modal de notificações
      const notifIcon = document.getElementById('notifIcon');
      const notifModal = document.getElementById('notifModal');

      if (notifIcon && notifModal) {
        notifIcon.addEventListener('click', () => {
          notifModal.classList.toggle('hidden');
        });

        document.addEventListener('click', (e) => {
          if (!notifIcon.contains(e.target) && !notifModal.contains(e.target)) {
            notifModal.classList.add('hidden');
          }
        });
      }
    </script>
  </body>
</html>
